```markdown
# Ø­Ù„ ØªØ­Ø¯ÙŠ Parameter Injection Ø¹Ù„Ù‰ CryptoHack: Ù…ØºØ§Ù…Ø±Ø© Ø§Ù„Ø³ÙˆÙƒØª ÙˆØ§Ù„ØªØ´ÙÙŠØ±! ğŸš€

> **ØªØ­Ø°ÙŠØ±:** Ø§Ù„Ù…Ù‚Ø§Ù„ Ø¯Ù‡ Ø¨ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù„ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„ØªØ­Ø¯ÙŠ **Parameter Injection** Ù…Ù† CryptoHack. Ù„Ùˆ Ø¹Ø§ÙŠØ² ØªØ­Ù„ Ø§Ù„ØªØ­Ø¯ÙŠ Ø¨Ù†ÙØ³Ùƒ, Ø¬Ø±Ø¨ Ø§Ù„Ø£ÙˆÙ„ ÙˆØ§Ø±Ø¬Ø¹ Ù„Ùˆ Ø§Ø­ØªØ¬Øª ØªÙ„Ù…ÙŠØ­!

## Ù…Ù‚Ø¯Ù…Ø©
ØªØ­Ø¯ÙŠ **Parameter Injection** Ù…Ù† Ù‚Ø³Ù… **Crypto** Ø¹Ù„Ù‰ [CryptoHack](https://cryptohack.org/) ÙƒØ§Ù† Ø²ÙŠ Ø±Ø­Ù„Ø© Ù…Ù„ÙŠØ§Ù†Ø© ØªØ´ÙˆÙŠÙ‚! ğŸ˜„ Ø§Ù„Ù‡Ø¯Ù ÙƒØ§Ù† Ù†Ø³ØªØºÙ„ Ø«ØºØ±Ø© ÙÙŠ ØªØ¨Ø§Ø¯Ù„ Ù…ÙØ§ØªÙŠØ­ **Diffie-Hellman** Ø¹Ø´Ø§Ù† Ù†ÙÙƒ ØªØ´ÙÙŠØ± Ø¹Ù„Ù… (flag) Ù…Ø´ÙØ± Ø¨Ù€ **AES-CBC**. Ø§Ù„ØªØ­Ø¯ÙŠ Ø¯Ù‡ Ù…Ø²ÙŠØ¬ Ø±Ø§Ø¦Ø¹ Ù…Ù† Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø³ÙˆÙƒØª, Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ JSON, ÙˆÙÙ‡Ù… Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„ØªØ´ÙÙŠØ±. Ø¨Ø¹Ø¯ Ù…Ø¹Ø§Ù†Ø§Ø© Ù…Ø¹ Ø£Ø®Ø·Ø§Ø¡ Ø²ÙŠ `JSONDecodeError` ÙˆÙ…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø­Ø´Ùˆ, ÙˆØµÙ„Øª Ù„Ù„Ø¹Ù„Ù…:  
**`crypto{n1c3_0n3_m4ll0ry!!!!!!!!}`** ğŸ‰  
ÙÙŠ Ø§Ù„Ù…Ù‚Ø§Ù„ Ø¯Ù‡, Ù‡Ø´Ø§Ø±Ùƒ Ø±Ø­Ù„ØªÙŠ Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©, Ù…Ù† Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ù„Ù„Ø­Ù„, Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù„ÙŠ ÙˆØ§Ø¬Ù‡ØªÙ†ÙŠ ÙˆØ§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù„ÙŠ Ø§ØªØ¹Ù„Ù…ØªÙ‡Ø§.

## ÙÙ‡Ù… Ø§Ù„ØªØ­Ø¯ÙŠ
### Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ
- Ø£Ù„ÙŠØ³ (Alice) ÙˆØ¨ÙˆØ¨ (Bob) Ø¨ÙŠØªØ¨Ø§Ø¯Ù„ÙˆØ§ Ù…ÙØ§ØªÙŠØ­ Diffie-Hellman Ø¹Ø¨Ø± Ø®Ø§Ø¯Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† `socket.cryptohack.org:13371`.
- Ø£Ù„ÙŠØ³ Ø¨ØªØ¨Ø¹Øª Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª:
  - \( p \): Ø¹Ø¯Ø¯ Ø£ÙˆÙ„ÙŠ ÙƒØ¨ÙŠØ±.
  - \( g \): Ø§Ù„Ù…ÙˆÙ„Ø¯ (generator).
  - \( A \): Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø£Ù„ÙŠØ³ (\( A = g^a \mod p \)).
- Ø¨ÙˆØ¨ Ø¨ÙŠØ¨Ø¹Øª:
  - \( B \): Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø¨ÙˆØ¨ (\( B = g^b \mod p \)).
- Ø¨Ø¹Ø¯ÙŠÙ†, Ø£Ù„ÙŠØ³ Ø¨ØªØ¨Ø¹Øª Ù†Øµ Ù…Ø´ÙØ± (ciphertext) Ù…Ø¹ Ù…ØªØ¬Ù‡ ØªÙ‡ÙŠØ¦Ø© (IV) Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… **AES-CBC**.
- Ø¯ÙˆØ±Ù†Ø§ (ÙƒÙ€ Mallory ÙÙŠ Ù‡Ø¬ÙˆÙ… man-in-the-middle) Ù†Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø´Ø§Ù† Ù†Ø¹Ø±Ù Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø´ØªØ±Ùƒ \( K \) ÙˆÙ†ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø¹Ù„Ù….

### Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
- Ù†Ø¹Ø¯Ù‘Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ù„ÙŠØ³ ÙˆØ¨ÙˆØ¨ Ø¹Ø´Ø§Ù† Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø´ØªØ±Ùƒ \( K \) ÙŠØ¨Ù‚Ù‰ Ù‚ÙŠÙ…Ø© Ù…Ø¹Ø±ÙˆÙØ© (Ø²ÙŠ \( K = 1 \)).
- Ù†Ø³ØªØ®Ø¯Ù… \( K \) Ù„Ø§Ø´ØªÙ‚Ø§Ù‚ Ù…ÙØªØ§Ø­ AES ÙˆÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´ÙØ± Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù„Ù….

### Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
Ù„Ùˆ Ø®Ù„ÙŠÙ†Ø§ \( g = 1 \), Ù‡ÙŠØ­ØµÙ„ Ø§Ù„Ø¢ØªÙŠ:
- \( A = g^a \mod p = 1^a \mod p = 1 \).
- \( B = g^b \mod p = 1^b \mod p = 1 \).
- Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø´ØªØ±Ùƒ:
  - Ø¹Ù†Ø¯ Ø£Ù„ÙŠØ³: \( K = B^a \mod p = 1^a \mod p = 1 \).
  - Ø¹Ù†Ø¯ Ø¨ÙˆØ¨: \( K = A^b \mod p = 1^b \mod p = 1 \).
- Ø¨ÙƒØ¯Ù‡, \( K = 1 \), ÙˆÙ†Ù‚Ø¯Ø± Ù†Ø³ØªØ®Ø¯Ù…Ù‡ Ù„Ø§Ø´ØªÙ‚Ø§Ù‚ Ù…ÙØªØ§Ø­ AES ÙˆÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±.

## Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„Ø­Ù„
### 1. Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…
- Ø§Ø³ØªØ®Ø¯Ù…Ù†Ø§ Ù…ÙƒØªØ¨Ø© `socket` ÙÙŠ Python Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ `socket.cryptohack.org:13371`.
- Ø¶Ø¨Ø·Ù†Ø§ Ù…Ù‡Ù„Ø© Ø²Ù…Ù†ÙŠØ© (`settimeout(10)`) Ø¹Ø´Ø§Ù† Ù†ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ù„Ùˆ Ø§Ù„Ø®Ø§Ø¯Ù… Ù…Ø§ Ø§Ø³ØªØ¬Ø§Ø¨Ø´.
- ÙƒØªØ¨Ù†Ø§ Ø¯Ø§Ù„Ø© `recv_line` Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø·Ø±Ù‹Ø§ Ø¨Ø³Ø·Ø± Ø¨Ø¯Ù„ `recv(1024)` Ø§Ù„Ù„ÙŠ Ù…Ù…ÙƒÙ† ØªÙ‚Ø·Ù‘Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.

### 2. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ÙˆØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ù„ÙŠØ³
- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø£Ù„ÙŠØ³ Ø¨ØªÙŠØ¬ÙŠ ÙƒÙ€ JSON Ù…Ø¹ Ù†ØµÙˆØµ Ø²ÙŠØ§Ø¯Ø©, Ø²ÙŠ:
  ```
  Intercepted from Alice: {"p": "0x...", "g": "0x02", "A": "0x..."}
  ```
- Ù†Ø¸ÙÙ†Ø§ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…:
  ```python
  data = data.replace("Intercepted from Alice:", "").strip()
  data = data.split("Send to Bob:")[0].strip()
  ```
- Ø­Ù„Ù„Ù†Ø§ JSON Ø¨Ù€ `json.loads` ÙˆØ¹Ø¯Ù‘Ù„Ù†Ø§ \( g \) Ù„Ù€ `hex(1)` (ÙŠØ¹Ù†ÙŠ \( g = 1 \)).
- Ø£Ø±Ø³Ù„Ù†Ø§ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ø¯Ù„Ø© Ù„Ø¨ÙˆØ¨.

### 3. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ÙˆØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙˆØ¨
- Ø¨ÙˆØ¨ Ø¨ÙŠØ¨Ø¹Øª Ø¨ÙŠØ§Ù†Ø§Øª Ø²ÙŠ:
  ```
  Send to Bob: Intercepted from Bob: {"B": "0x1"}
  ```
- Ù†Ø¸ÙÙ†Ø§ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù€:
  ```python
  bob_data = bob_data.replace("Send to Bob:", "").replace("Intercepted from Bob:", "").strip()
  bob_data = bob_data.split("Send to Alice:")[0].strip()
  ```
- Ø­Ù„Ù„Ù†Ø§ JSON, ÙˆØªØ£ÙƒØ¯Ù†Ø§ Ø¥Ù† \( B = 1 \) (ÙˆÙ‡Ùˆ Ù…ØªÙˆÙ‚Ø¹ Ù„Ø£Ù† \( g = 1 \)).
- Ø¹Ø¯Ù‘Ù„Ù†Ø§ \( B = hex(1) \) ÙˆØ£Ø±Ø³Ù„Ù†Ø§Ù‡Ø§ Ù„Ø£Ù„ÙŠØ³.

### 4. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©
- Ø£Ù„ÙŠØ³ Ø¨ØªØ¨Ø¹Øª Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´ÙØ± ÙƒÙ€ JSON:
  ```
  Send to Alice: Intercepted from Alice: {"iv": "...", "encrypted_flag": "..."}
  ```
- Ù†Ø¸ÙÙ†Ø§ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù€:
  ```python
  encrypted_data = encrypted_data.replace("Send to Alice:", "").replace("Intercepted from Alice:", "").strip()
  encrypted_data = encrypted_data.split("Encrypted data:")[0].strip()
  ```
- Ø­Ù„Ù„Ù†Ø§ JSON ÙˆØ§Ø³ØªØ®Ø±Ø¬Ù†Ø§:
  - `iv`: Ù…ØªØ¬Ù‡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© (hex-encoded).
  - `encrypted_flag`: Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´ÙØ± (hex-encoded).
- Ø­ÙˆÙ„Ù†Ø§Ù‡Ù… Ù„Ø¨Ø§ÙŠØªØ§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… `binascii.unhexlify`.

### 5. ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±
- Ø§Ø´ØªÙ‚ÙŠÙ†Ø§ Ù…ÙØªØ§Ø­ AES Ù…Ù† \( K = 1 \):
  ```python
  K = 1
  key = hashlib.sha1(str(K).encode()).digest()[:16]
  ```
- Ø§Ø³ØªØ®Ø¯Ù…Ù†Ø§ Ù…ÙƒØªØ¨Ø© `pycryptodome` Ù„ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ù†Øµ Ø¨Ù€ AES-CBC:
  ```python
  cipher = AES.new(key, AES.MODE_CBC, iv)
  plaintext = cipher.decrypt(ciphertext)
  ```
- Ø­Ø§ÙˆÙ„Ù†Ø§ Ù†Ø²ÙŠÙ„ Ø§Ù„Ø­Ø´Ùˆ (PKCS#7) Ø¨Ù€:
  ```python
  padding_len = plaintext[-1]
  plaintext = plaintext[:-padding_len]
  ```
- Ù„ÙƒÙ† ÙˆØ§Ø¬Ù‡Ù†Ø§ Ù…Ø´ÙƒÙ„Ø© Ø¥Ù† Ø§Ù„Ø­Ø´Ùˆ ÙƒØ§Ù† ØºÙŠØ± ØµØ§Ù„Ø­, ÙØ·Ø¨Ø¹Ù†Ø§ Ø§Ù„Ù†Øµ Ø§Ù„Ø®Ø§Ù… Ø¨Ø¯ÙˆÙ† Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø´Ùˆ:
  ```python
  plaintext.decode('utf-8', errors='ignore')
  ```
- Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙƒØ§Ù†Øª Ø§Ù„Ø¹Ù„Ù…: **`crypto{n1c3_0n3_m4ll0ry!!!!!!!!}`**!

## Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª ÙˆØ§Ù„Ø£Ø®Ø·Ø§Ø¡
Ø±Ø­Ù„Ø© Ø§Ù„Ø­Ù„ ÙƒØ§Ù†Øª Ù…Ù„ÙŠØ§Ù†Ø© ØªØ­Ø¯ÙŠØ§Øª, ÙˆÙƒÙ„ Ø®Ø·Ø£ Ø¹Ù„Ù‘Ù…Ù†ÙŠ Ø­Ø§Ø¬Ø© Ø¬Ø¯ÙŠØ¯Ø©:
1. **Timeout Error:**
   - Ø§Ù„ÙƒÙˆØ¯ ÙƒØ§Ù† Ø¨ÙŠØªÙˆÙ‚Ù Ø¹Ù†Ø¯ `Waiting for data...`.
   - Ø§Ù„Ø­Ù„: Ø£Ø¶ÙÙ†Ø§ `settimeout(10)` ÙˆØ¯Ø§Ù„Ø© `recv_line` Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¯Ù‚Ø©.
2. **JSONDecodeError:**
   - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù†Øª Ø¨ØªÙŠØ¬ÙŠ Ù…Ø¹ Ù†ØµÙˆØµ Ø²ÙŠØ§Ø¯Ø© Ø²ÙŠ `"Send to Bob:"` Ùˆ`"Intercepted from Alice:"`.
   - Ø§Ù„Ø­Ù„: Ø§Ø³ØªØ®Ø¯Ù…Ù†Ø§ `replace` Ùˆ`split` Ù…ØªØ¹Ø¯Ø¯Ø© Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ `json.loads`.
3. **Invalid Padding:**
   - Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø´Ùˆ (PKCS#7) ÙƒØ§Ù†Øª Ø¨ØªÙØ´Ù„ Ù„Ø£Ù† `plaintext[-1]` ÙƒØ§Ù† Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©.
   - Ø§Ù„Ø­Ù„: Ø·Ø¨Ø¹Ù†Ø§ Ø§Ù„Ù†Øµ Ø§Ù„Ø®Ø§Ù… Ø¨Ø¯ÙˆÙ† Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø´Ùˆ, ÙˆØ·Ù„Ø¹ Ø§Ù„Ø¹Ù„Ù…!
4. **SyntaxError:**
   - ÙˆØ§Ø¬Ù‡Ù†Ø§ Ø®Ø·Ø£ ÙÙŠ ÙƒØªÙ„Ø© `except Exception as` Ø¨Ø¯ÙˆÙ† Ù…ØªØºÙŠØ±.
   - Ø§Ù„Ø­Ù„: Ø¹Ø¯Ù‘Ù„Ù†Ø§Ù‡Ø§ Ù„Ù€ `except Exception as e`.

## Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
> **ØªØ­Ø°ÙŠØ±:** Ø§Ù„ÙƒÙˆØ¯ Ø¯Ù‡ Ø§Ù„Ø­Ù„ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„ØªØ­Ø¯ÙŠ. Ù„Ùˆ Ø¹Ø§ÙŠØ² ØªØ­Ù„ Ø¨Ù†ÙØ³Ùƒ, Ø¨Ù„Ø§Ø´ ØªÙ‚Ø±Ø§Ù‡!

```python
import socket
import json
import hashlib
from Crypto.Cipher import AES
import binascii

# Ø¯Ø§Ù„Ø© Ù„Ù‚Ø±Ø§Ø¡Ø© Ø³Ø·Ø± ÙˆØ§Ø­Ø¯
def recv_line(client):
    data = b""
    while not data.endswith(b'\n'):
        chunk = client.recv(1)
        if not chunk:
            break
        data += chunk
    return data.decode()

# Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…
print("[*] Connecting to socket.cryptohack.org:13371")
client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.settimeout(10)
try:
    client.connect(('socket.cryptohack.org', 13371))
except socket.timeout:
    print("[!] Connection timeout. Check your internet and try again.")
    client.close()
    exit(1)

# Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ÙˆØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ù„ÙŠØ³
print("[*] Waiting for data from Alice...")
try:
    data = recv_line(client)
    print(f"[*] Raw Alice data: {data}")
    if data.startswith("Intercepted from Alice:"):
        data = data.replace("Intercepted from Alice:", "").strip()
    data = data.split("Send to Bob:")[0].strip()
    print(f"[*] Cleaned Alice data: {data}")
    alice_data = json.loads(data)
    alice_data['g'] = hex(1)
    client.send((json.dumps(alice_data) + '\n').encode())
    print("[*] Sent modified Alice data (g = 1) to Bob")
except socket.timeout:
    print("[!] Timeout while receiving Alice data.")
    client.close()
    exit(1)
except json.JSONDecodeError as e:
    print(f"[!] JSON decode error: {e}")
    print(f"[!] Raw data: {data}")
    client.close()
    exit(1)

# Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ÙˆØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙˆØ¨
print("[*] Waiting for data from Bob...")
try:
    bob_data = recv_line(client)
    print(f"[*] Raw Bob data: {bob_data}")
    bob_data = bob_data.replace("Send to Bob:", "").replace("Intercepted from Bob:", "").strip()
    bob_data = bob_data.split("Send to Alice:")[0].strip()
    print(f"[*] Cleaned Bob data: {bob_data}")
    bob_data = json.loads(bob_data)
    print(f"[*] Parsed Bob data: {bob_data}")
    bob_data['B'] = hex(1)
    client.send((json.dumps(bob_data) + '\n').encode())
    print("[*] Sent modified data (B = 1) to Alice")
except socket.timeout:
    print("[!] Timeout while receiving Bob data.")
    client.close()
    exit(1)
except json.JSONDecodeError as e:
    print(f"[!] JSON decode error: {e}")
    print(f"[!] Raw data: {bob_data}")
    client.close()
    exit(1)

# Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©
print("[*] Waiting for encrypted data...")
try:
    encrypted_data = recv_line(client)
    print(f"[*] Raw encrypted data: {encrypted_data}")
    encrypted_data = encrypted_data.replace("Send to Alice:", "").replace("Intercepted from Alice:", "").strip()
    encrypted_data = encrypted_data.split("Encrypted data:")[0].strip()
    print(f"[*] Cleaned encrypted data: {encrypted_data}")
    encrypted_data = json.loads(encrypted_data)
    print(f"[*] Parsed encrypted data: {encrypted_data}")
except socket.timeout:
    print("[!] Timeout while receiving encrypted data.")
    client.close()
    exit(1)
except json.JSONDecodeError as e:
    print(f"[!] JSON decode error: {e}")
    print(f"[!] Raw data: {encrypted_data}")
    client.close()
    exit(1)

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ ciphertext Ùˆ IV
try:
    iv = binascii.unhexlify(encrypted_data['iv'])
    ciphertext = binascii.unhexlify(encrypted_data['encrypted_flag'])
    print(f"[*] IV: {iv.hex()}")
    print(f"[*] Ciphertext: {ciphertext.hex()}")
except KeyError as e:
    print(f"[!] Key error: {e}")
    print(f"[!] Encrypted data: {encrypted_data}")
    client.close()
    exit(1)

# Ø§Ø´ØªÙ‚Ø§Ù‚ Ù…ÙØªØ§Ø­ AES Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… K = 1
K = 1
key = hashlib.sha1(str(K).encode()).digest()[:16]
print(f"[*] AES key: {key.hex()}")

# ÙÙƒ ØªØ´ÙÙŠØ± AES-CBC
try:
    cipher = AES.new(key, AES.MODE_CBC, iv)
    plaintext = cipher.decrypt(ciphertext)
    print(f"[*] Raw decrypted plaintext (hex): {plaintext.hex()}")
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø´Ùˆ (PKCS#7)
    padding_len = plaintext[-1]
    if 1 <= padding_len <= 16 and plaintext[-padding_len:] == bytes([padding_len]) * padding_len:
        plaintext = plaintext[:-padding_len]
        print(f"[*] Decrypted flag: {plaintext.decode()}")
    else:
        print(f"[!] Invalid padding: padding_len={padding_len}, plaintext={plaintext.hex()}")
        print(f"[*] Decrypted flag (without padding removal): {plaintext.decode('utf-8', errors='ignore')}")
except UnicodeDecodeError as e:
    print(f"[!] Unicode decode error: {e}")
    print(f"[*] Raw plaintext (hex): {plaintext.hex()}")
    print(f"[*] Decrypted flag (raw): {plaintext.decode('utf-8', errors='ignore')}")
except Exception as e:
    print(f"[!] Decryption error: {e}")
    client.close()
    exit(1)

# Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø§ØªØµØ§Ù„
client.close()
```

## Ø§Ù„Ù†ØªÙŠØ¬Ø©
Ø¨Ø¹Ø¯ Ø±Ø­Ù„Ø© Ù…Ù„ÙŠØ§Ù†Ø© Ø£Ø®Ø·Ø§Ø¡ ÙˆØªØµØ­ÙŠØ­Ø§Øª, ÙˆØµÙ„Ù†Ø§ Ù„Ù„Ø¹Ù„Ù…:
**`crypto{n1c3_0n3_m4ll0ry!!!!!!!!}`** ğŸ‰  
Ø§Ù„Ø¹Ù„Ù… Ø¨ÙŠÙ„Ù…Ø­ Ù„Ø¯ÙˆØ± **Mallory** ÙÙŠ Ù‡Ø¬ÙˆÙ… man-in-the-middle, ÙˆÙƒØ§Ù† Ø´Ø¹ÙˆØ± Ø§Ù„Ù†ØµØ± Ù„Ø§ ÙŠÙØ¶Ø§Ù‡Ù‰! ğŸ˜

## Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†
- **Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø³ÙˆÙƒØª:** Ø§Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ù„Ø© Ø²ÙŠ `recv_line` Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙˆÙƒØª Ø¨Ø¯Ù‚Ø©.
- **ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** ÙƒÙ† Ø¬Ø§Ù‡Ø² Ù„Ù†ØµÙˆØµ Ø²ÙŠØ§Ø¯Ø© ÙÙŠ JSON. Ø§Ø³ØªØ®Ø¯Ù… `replace` Ùˆ`split` Ø¨Ù…Ø±ÙˆÙ†Ø©.
- **Ø§Ù„ØªØ´ÙÙŠØ±:** Ø§ÙÙ‡Ù… Ø£Ø³Ø§Ø³ÙŠØ§Øª **AES-CBC** ÙˆØ§Ù„Ø­Ø´Ùˆ (PKCS#7) Ù‚Ø¨Ù„ Ù…Ø§ ØªØ¨Ø¯Ø£.
- **ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:** Ø§Ø·Ø¨Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù… Ø¯Ø§ÙŠÙ…Ù‹Ø§ (raw data) Ø¹Ø´Ø§Ù† ØªØ¹Ø±Ù Ù…ØµØ¯Ø± Ø§Ù„Ù…Ø´ÙƒÙ„Ø©.
- **Ø§Ù„ØµØ¨Ø± Ù…ÙØªØ§Ø­ Ø§Ù„Ù†Ø¬Ø§Ø­:** Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø±Ø­Ù„Ø©. ÙƒÙ„ Ø®Ø·Ø£ Ø¨ÙŠØ¹Ù„Ù…Ùƒ Ø­Ø§Ø¬Ø© Ø¬Ø¯ÙŠØ¯Ø©!

## Ø¯Ø±ÙˆØ³ Ù…Ø³ØªÙØ§Ø¯Ø©
- **Diffie-Hellman:** ÙÙ‡Ù…Øª Ø¥Ø²Ø§ÙŠ ØªØ¹Ø¯ÙŠÙ„ \( g \) Ù…Ù…ÙƒÙ† ÙŠØ®Ø±Ù‘Ø¨ ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ù…ÙØ§ØªÙŠØ­.
- **Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø³ÙˆÙƒØª:** Ø§ØªØ¹Ù„Ù…Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙˆÙƒØª ÙˆØªÙ†Ø¸ÙŠÙÙ‡Ø§.
- **AES-CBC:** Ø¹Ø±ÙØª Ø¥Ø²Ø§ÙŠ Ø£ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ù†ØµÙˆØµ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙØªØ§Ø­ ÙˆIV.
- **Ø§Ù„Ø­Ø´Ùˆ:** Ø§ÙƒØªØ´ÙØª Ø£Ù‡Ù…ÙŠØ© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø´Ùˆ (PKCS#7) ÙˆØ§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª ØºÙŠØ± Ø§Ù„ØµØ§Ù„Ø­Ø©.
- **Ø§Ù„Ù…Ø«Ø§Ø¨Ø±Ø©:** ÙˆØ§Ø¬Ù‡Øª Ø£Ø®Ø·Ø§Ø¡ Ø²ÙŠ Timeout ÙˆJSON decode, Ø¨Ø³ Ø§Ù„ØµØ¨Ø± ÙƒØ§Ù† Ù…ÙØªØ§Ø­ Ø§Ù„Ù†Ø¬Ø§Ø­!

## Ø§Ù„Ø®Ø§ØªÙ…Ø©
ØªØ­Ø¯ÙŠ **Parameter Injection** ÙƒØ§Ù† Ù…ØºØ§Ù…Ø±Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©! ğŸ˜„ ØªØ¹Ù„Ù…Øª Ù…Ù†Ù‡ ÙƒØªÙŠØ± Ø¹Ù† Ø§Ù„ØªØ´ÙÙŠØ±, Ø§Ù„Ø³ÙˆÙƒØª, ÙˆØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡. Ø´ÙƒØ± Ø®Ø§Øµ Ù„Ù€ [CryptoHack](https://cryptohack.org/) Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„Ù…Ù…ØªØ¹Ø©, ÙˆÙ„Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù„ÙŠ Ø¯Ø§ÙŠÙ…Ù‹Ø§ Ø¨ÙŠØ¯Ø¹Ù…. Ù„Ùˆ Ø¹Ø§ÙŠØ² ØªØ­Ù„ ØªØ­Ø¯ÙŠØ§Øª Ø²ÙŠ Ø¯ÙŠ, Ø§Ø¨Ø¯Ø£ Ø¨Ù€ Python, Ù…ÙƒØªØ¨Ø© `pycryptodome`, ÙˆØ´ÙˆÙŠØ© ØµØ¨Ø±! ğŸš€  
Ù„Ùˆ Ø¹Ø¬Ø¨Ùƒ Ø§Ù„Ù€ write-up Ø£Ùˆ Ø¹Ù†Ø¯Ùƒ Ø£Ø³Ø¦Ù„Ø© Ø¹Ù† Ø§Ù„ØªØ­Ø¯ÙŠ, Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚ Ø£Ùˆ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ø§ÙŠØ§! Ù…Ø³ØªÙ†ÙŠ Ø£Ø´ÙˆÙÙƒÙ… ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠ Ø§Ù„Ø¬Ø§ÙŠ! ğŸ˜

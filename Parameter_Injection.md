# ุญู ุชุญุฏู Parameter Injection ุนูู CryptoHack: ูุบุงูุฑุฉ ุงูุณููุช ูุงูุชุดููุฑ! ๐

> **ุชุญุฐูุฑ:** ุงูููุงู ุฏู ุจูุญุชูู ุนูู ุงูุญู ุงููุงูู ูุชุญุฏู **Parameter Injection** ูู CryptoHack. ูู ุนุงูุฒ ุชุญู ุงูุชุญุฏู ุจููุณู, ุฌุฑุจ ุงูุฃูู ูุงุฑุฌุน ูู ุงุญุชุฌุช ุชูููุญ!

## ููุฏูุฉ
ุชุญุฏู **Parameter Injection** ูู ูุณู **Crypto** ุนูู [CryptoHack](https://cryptohack.org/) ูุงู ุฒู ุฑุญูุฉ ูููุงูุฉ ุชุดููู! ๐ ุงููุฏู ูุงู ูุณุชุบู ุซุบุฑุฉ ูู ุชุจุงุฏู ููุงุชูุญ **Diffie-Hellman** ุนุดุงู ููู ุชุดููุฑ ุนูู (flag) ูุดูุฑ ุจู **AES-CBC**. ุงูุชุญุฏู ุฏู ูุฒูุฌ ุฑุงุฆุน ูู ุจุฑูุฌุฉ ุงูุณููุช, ุงูุชุนุงูู ูุน JSON, ูููู ุฃุณุงุณูุงุช ุงูุชุดููุฑ. ุจุนุฏ ูุนุงูุงุฉ ูุน ุฃุฎุทุงุก ุฒู `JSONDecodeError` ููุดุงูู ุงูุญุดู, ูุตูุช ููุนูู:  
**`crypto{n1c3_0n3_m4ll0ry!!!!!!!!}`** ๐  
ูู ุงูููุงู ุฏู, ูุดุงุฑู ุฑุญูุชู ุฎุทูุฉ ุจุฎุทูุฉ, ูู ุงูุชุญููู ููุญู, ูุน ูู ุงูุฃุฎุทุงุก ุงููู ูุงุฌูุชูู ูุงูุฏุฑูุณ ุงููู ุงุชุนููุชูุง.

## ููู ุงูุชุญุฏู
### ุงูุณููุงุฑูู
- ุฃููุณ (Alice) ูุจูุจ (Bob) ุจูุชุจุงุฏููุง ููุงุชูุญ Diffie-Hellman ุนุจุฑ ุฎุงุฏู ุนูู ุงูุนููุงู `socket.cryptohack.org:13371`.
- ุฃููุณ ุจุชุจุนุช ุงููุนุงููุงุช:
  - \( p \): ุนุฏุฏ ุฃููู ูุจูุฑ.
  - \( g \): ุงููููุฏ (generator).
  - \( A \): ุงููููุฉ ุงูุนุงูุฉ ูุฃููุณ (\( A = g^a \mod p \)).
- ุจูุจ ุจูุจุนุช:
  - \( B \): ุงููููุฉ ุงูุนุงูุฉ ูุจูุจ (\( B = g^b \mod p \)).
- ุจุนุฏูู, ุฃููุณ ุจุชุจุนุช ูุต ูุดูุฑ (ciphertext) ูุน ูุชุฌู ุชููุฆุฉ (IV) ุจุงุณุชุฎุฏุงู **AES-CBC**.
- ุฏูุฑูุง (ูู Mallory ูู ูุฌูู man-in-the-middle) ูุนุฏูู ุงูุจูุงูุงุช ุนุดุงู ูุนุฑู ุงูููุชุงุญ ุงููุดุชุฑู \( K \) ูููู ุชุดููุฑ ุงูุนูู.

### ุงููุทููุจ
- ูุนุฏูู ุจูุงูุงุช ุฃููุณ ูุจูุจ ุนุดุงู ุงูููุชุงุญ ุงููุดุชุฑู \( K \) ูุจูู ูููุฉ ูุนุฑููุฉ (ุฒู \( K = 1 \)).
- ูุณุชุฎุฏู \( K \) ูุงุดุชูุงู ููุชุงุญ AES ููู ุชุดููุฑ ุงููุต ุงููุดูุฑ ููุญุตูู ุนูู ุงูุนูู.

### ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ
ูู ุฎูููุง \( g = 1 \), ููุญุตู ุงูุขุชู:
- \( A = g^a \mod p = 1^a \mod p = 1 \).
- \( B = g^b \mod p = 1^b \mod p = 1 \).
- ุงูููุชุงุญ ุงููุดุชุฑู:
  - ุนูุฏ ุฃููุณ: \( K = B^a \mod p = 1^a \mod p = 1 \).
  - ุนูุฏ ุจูุจ: \( K = A^b \mod p = 1^b \mod p = 1 \).
- ุจูุฏู, \( K = 1 \), ูููุฏุฑ ูุณุชุฎุฏูู ูุงุดุชูุงู ููุชุงุญ AES ููู ุงูุชุดููุฑ.

## ุงูุชุญููู ูุงูุญู
### 1. ุงูุงุชุตุงู ุจุงูุฎุงุฏู
- ุงุณุชุฎุฏููุง ููุชุจุฉ `socket` ูู Python ููุงุชุตุงู ุจู `socket.cryptohack.org:13371`.
- ุถุจุทูุง ูููุฉ ุฒูููุฉ (`settimeout(10)`) ุนุดุงู ูุชุฌูุจ ุงูุชุนููู ูู ุงูุฎุงุฏู ูุง ุงุณุชุฌุงุจุด.
- ูุชุจูุง ุฏุงูุฉ `recv_line` ููุฑุงุกุฉ ุงูุจูุงูุงุช ุณุทุฑูุง ุจุณุทุฑ ุจุฏู `recv(1024)` ุงููู ูููู ุชูุทูุน ุงูุจูุงูุงุช.

### 2. ุงุณุชูุจุงู ูุชุนุฏูู ุจูุงูุงุช ุฃููุณ
- ุงูุจูุงูุงุช ูู ุฃููุณ ุจุชูุฌู ูู JSON ูุน ูุตูุต ุฒูุงุฏุฉ, ุฒู:
